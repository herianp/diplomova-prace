---
phase: 03-code-quality-typescript
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/i18n/index.js
  - src/i18n/cs-CZ/index.js
  - src/i18n/cs-CZ/errors.js
  - src/i18n/en-US/index.js
  - src/i18n/en-US/errors.js
  - src/boot/i18n.js
autonomous: true

must_haves:
  truths:
    - "i18n translation key typos caught at compile time"
    - "Existing translations still render correctly in the application"
  artifacts:
    - path: "src/i18n/cs-CZ/index.ts"
      provides: "Czech locale with as const for type inference"
      contains: "as const"
    - path: "src/i18n/en-US/index.ts"
      provides: "English locale matching Czech schema"
      contains: "as const"
    - path: "src/i18n/index.ts"
      provides: "i18n module with MessageSchema type export"
      contains: "MessageSchema"
    - path: "src/boot/i18n.ts"
      provides: "Type-safe i18n boot with createI18n generic"
      contains: "createI18n"
  key_links:
    - from: "src/boot/i18n.ts"
      to: "src/i18n/index.ts"
      via: "import messages and MessageSchema"
      pattern: "import.*from.*src/i18n"
    - from: "src/i18n/index.ts"
      to: "src/i18n/cs-CZ/index.ts"
      via: "import default"
      pattern: "import.*cs-CZ"
---

<objective>
Convert i18n locale files from JavaScript to TypeScript with `as const` assertions for compile-time translation key validation.

Purpose: Catch translation key typos at compile time instead of silent runtime failures (QAL-04).
Output: TypeScript locale files with type-safe i18n configuration.
</objective>

<execution_context>
@C:/Users/Developer/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Developer/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-code-quality-typescript/03-RESEARCH.md
@src/i18n/index.js
@src/i18n/cs-CZ/index.js
@src/i18n/en-US/index.js
@src/boot/i18n.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Convert i18n locale files from JS to TS with as const</name>
  <files>
    src/i18n/cs-CZ/index.js
    src/i18n/cs-CZ/errors.js
    src/i18n/en-US/index.js
    src/i18n/en-US/errors.js
    src/i18n/index.js
  </files>
  <action>
1. Rename all locale files from .js to .ts:
   - `src/i18n/cs-CZ/index.js` -> `src/i18n/cs-CZ/index.ts`
   - `src/i18n/cs-CZ/errors.js` -> `src/i18n/cs-CZ/errors.ts`
   - `src/i18n/en-US/index.js` -> `src/i18n/en-US/index.ts`
   - `src/i18n/en-US/errors.js` -> `src/i18n/en-US/errors.ts`
   - `src/i18n/index.js` -> `src/i18n/index.ts`

   Use `git mv` for each rename to preserve git history.

2. In each errors.ts file, add `as const` to the export:
   ```typescript
   export default {
     auth: { ... },
     firestore: { ... },
     // ...
   } as const
   ```

3. In each locale index.ts file (cs-CZ/index.ts, en-US/index.ts):
   - Update the import from `'./errors.js'` to `'./errors'` (drop .js extension)
   - Add `as const` satisfies assertion to the export:
   ```typescript
   import errors from './errors'

   export default {
     errors,
     app: { ... },
     survey: { ... },
     // ... all existing keys unchanged
   } as const
   ```

4. In `src/i18n/index.ts`:
   - Update imports to drop .js extensions (if any)
   - Export a `MessageSchema` type derived from the Czech locale (primary locale):
   ```typescript
   import enUS from './en-US'
   import csCZ from './cs-CZ'

   export type MessageSchema = typeof csCZ

   export default {
     'en-US': enUS,
     'cs-CZ': csCZ
   }
   ```

5. Verify en-US has the SAME key structure as cs-CZ. If any keys are missing in en-US, add them with English translations. TypeScript will enforce structural matching when both are used as MessageSchema.
  </action>
  <verify>Run `npx tsc --noEmit` — no errors related to i18n files. Check that `MessageSchema` type is exported from `src/i18n/index.ts`.</verify>
  <done>All 5 i18n files converted to TypeScript with `as const`. MessageSchema type exported for compile-time key validation.</done>
</task>

<task type="auto">
  <name>Task 2: Update i18n boot file for type-safe configuration</name>
  <files>src/boot/i18n.js</files>
  <action>
1. Rename `src/boot/i18n.js` to `src/boot/i18n.ts` using `git mv`.

2. Rewrite as type-safe i18n boot:
   ```typescript
   import { defineBoot } from '#q-app/wrappers'
   import { createI18n } from 'vue-i18n'
   import messages from 'src/i18n'
   import type { MessageSchema } from 'src/i18n'

   export default defineBoot(({ app }) => {
     const savedLocale = localStorage.getItem('app-locale') as 'cs-CZ' | 'en-US' | null

     const i18n = createI18n<[MessageSchema], 'cs-CZ' | 'en-US'>({
       locale: savedLocale || 'cs-CZ',
       fallbackLocale: 'en-US',
       globalInjection: true,
       messages,
     })

     app.use(i18n)
   })
   ```

   Note: Check if the existing boot file reads locale from localStorage (the Settings page has language switching with localStorage persistence per CLAUDE.md). If it does, preserve that logic. If not, the simple version above is fine. The key change is adding the generic type parameter `<[MessageSchema], 'cs-CZ' | 'en-US'>` to `createI18n`.

3. Update `quasar.config.ts` boot array if it references `'i18n'` — Quasar auto-resolves extensions, so this likely needs no change, but verify.

4. IMPORTANT: Vue i18n with `legacy: false` (Composition API mode) is needed for TypeScript generics to work. Check if the existing setup uses legacy mode. If `legacy` is not set, it defaults to `true` in Vue i18n 9.x. If the app uses `$t()` in templates (Options API style), keep `legacy: true` but note that full compile-time key validation requires Composition API mode. If switching to `legacy: false` would break template `$t()` usage, keep `legacy: true` and rely on the `MessageSchema` type for `useI18n()` calls in script sections only. Do NOT break existing template translations.
  </action>
  <verify>Run `npx quasar dev` — app starts, switch language in Settings page, verify translations still work in both Czech and English. Run `npx tsc --noEmit` — no errors.</verify>
  <done>i18n boot file converted to TypeScript with type-safe createI18n generic. Existing translations work unchanged.</done>
</task>

</tasks>

<verification>
- All i18n files are .ts (no .js remaining in src/i18n/)
- `MessageSchema` type is exported from `src/i18n/index.ts`
- `npx tsc --noEmit` passes with zero errors
- Application loads and displays translations in both Czech and English
- Language switching in Settings page still works
</verification>

<success_criteria>
i18n translation key typos are caught at compile time. All locale files are TypeScript with `as const`. Boot file uses typed createI18n. Existing translations render correctly.
</success_criteria>

<output>
After completion, create `.planning/phases/03-code-quality-typescript/03-02-SUMMARY.md`
</output>
