---
phase: 12-team-discovery-join-requests
plan: "02"
type: execute
wave: 2
depends_on: ["12-01"]
files_modified:
  - src/components/onboarding/TeamBrowseList.vue
  - src/composable/useOnboardingComposable.ts
  - src/components/onboarding/OnboardingWizard.vue
  - src/components/onboarding/OnboardingWizardMobile.vue
  - src/i18n/en-US/index.ts
  - src/i18n/cs-CZ/index.ts
autonomous: true
requirements:
  - DISC-01
  - DISC-02

must_haves:
  truths:
    - "A teamless user sees a list of all teams with name and member count in the onboarding wizard step 3 browse path"
    - "User can filter teams by name using a text input at the top"
    - "Teams where user has a pending request show 'Request Pending' badge with join button disabled"
    - "Teams where user is already a member show 'Member' badge"
    - "User can tap a team to see a confirmation dialog and send a join request with toast feedback"
    - "User can cancel a pending request directly from the browse list"
  artifacts:
    - path: "src/components/onboarding/TeamBrowseList.vue"
      provides: "Reusable team browse list component with filtering, badges, and join/cancel actions"
      min_lines: 80
    - path: "src/composable/useOnboardingComposable.ts"
      provides: "Updated composable with join request methods"
      contains: "sendJoinRequest"
  key_links:
    - from: "src/components/onboarding/TeamBrowseList.vue"
      to: "src/composable/useJoinRequestUseCases.ts"
      via: "composable method calls for join/cancel"
      pattern: "useJoinRequestUseCases"
    - from: "src/components/onboarding/OnboardingWizard.vue"
      to: "src/components/onboarding/TeamBrowseList.vue"
      via: "component import replacing placeholder"
      pattern: "TeamBrowseList"
---

<objective>
Build the team browse list UI component and integrate it into the onboarding wizard step 3, replacing the browse placeholder banner.

Purpose: Enables DISC-01 (browse teams) and DISC-02 (send join request) from the onboarding wizard. Creates a reusable TeamBrowseList component that will also be used on the standalone /teams page in plan 03.

Output: Working team browsing and join request flow inside the onboarding wizard.
</objective>

<execution_context>
@C:/Users/Developer/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Developer/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-team-discovery-join-requests/12-CONTEXT.md
@.planning/phases/12-team-discovery-join-requests/12-01-SUMMARY.md
@src/composable/useOnboardingComposable.ts
@src/components/onboarding/OnboardingWizard.vue
@src/components/onboarding/OnboardingWizardMobile.vue
@src/interfaces/interfaces.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TeamBrowseList component and wire join request flow</name>
  <files>
    src/components/onboarding/TeamBrowseList.vue
    src/i18n/en-US/index.ts
    src/i18n/cs-CZ/index.ts
  </files>
  <action>
**1. Create `src/components/onboarding/TeamBrowseList.vue`:**

A reusable component that shows all teams with filtering and join request capabilities. Uses Quasar components.

**Props:** none (self-contained — fetches data internally via composables)

**Template structure:**
- `q-input` at top: outlined, dense, debounce="300", icon "search", v-model `filterText`, clearable. Placeholder from i18n.
- `q-list` with `q-item` for each filtered team:
  - `q-item-section avatar`: `q-icon` "groups"
  - `q-item-section`: team name as `q-item-label`, member count as `q-item-label caption` (e.g., "12 members")
  - `q-item-section side`:
    - If user is member of this team: `q-badge` color="positive" label from i18n ("Member")
    - If user has pending request: `q-badge` color="warning" label from i18n ("Request Pending") + `q-btn` flat dense icon "close" @click `cancelRequest(request.id)` with tooltip "Cancel request"
    - Otherwise: `q-btn` flat dense color="primary" label from i18n ("Join") @click `confirmJoinRequest(team)`
- `q-dialog` for join confirmation: "Send join request to [Team Name]?" with Send and Cancel buttons.
- Empty state: `q-banner` when no teams exist or no matches.
- Loading state: `q-spinner` while teams load.

**Script setup:**
- Import `useJoinRequestUseCases` and `useTeamStore` and `useAuthStore`
- Call `setAllTeamsListener` on mount (via `onMounted`), store unsubscribe, call on `onUnmounted`
- Call `setUserJoinRequestsListener` on mount for current user's requests
- `filterText` ref for search input
- `allTeams` ref<ITeam[]> populated by listener
- `userRequests` ref<IJoinRequest[]> populated by listener
- Computed `filteredTeams`: filter allTeams by name containing filterText (case-insensitive), sort alphabetically by name
- Computed helpers: `isUserMember(teamId)` checks teamStore.teams, `getUserPendingRequest(teamId)` finds pending request from userRequests
- `confirmJoinRequest(team)` — shows q-dialog confirmation
- `sendJoinRequest(team)` — calls useJoinRequestUseCases().sendJoinRequest(team.id, team.name), shows success toast via `$q.notify({ type: 'positive', message: i18n('joinRequest sent to [name]') })`, catches error and shows error toast
- `cancelRequest(requestId)` — calls useJoinRequestUseCases().cancelJoinRequest(requestId), shows toast

**2. Add i18n translations:**

In both `en-US/index.ts` and `cs-CZ/index.ts`, add a `teamBrowse` block inside the `onboarding` section:

English:
```
teamBrowse: {
  searchPlaceholder: 'Search teams...',
  memberBadge: 'Member',
  pendingBadge: 'Request Pending',
  joinButton: 'Join',
  cancelRequest: 'Cancel Request',
  confirmTitle: 'Join Request',
  confirmMessage: 'Send join request to {teamName}?',
  confirmSend: 'Send',
  confirmCancel: 'Cancel',
  requestSent: 'Join request sent to {teamName}',
  requestCancelled: 'Join request cancelled',
  noTeams: 'No teams available yet',
  noResults: 'No teams match your search',
  memberCount: '{count} members',
  maxRequests: 'You can have at most 5 pending requests',
  alreadyMember: 'You are already a member of this team'
}
```

Czech:
```
teamBrowse: {
  searchPlaceholder: 'Hledat tymy...',
  memberBadge: 'Clen',
  pendingBadge: 'Zadost odeslana',
  joinButton: 'Pridat se',
  cancelRequest: 'Zrusit zadost',
  confirmTitle: 'Zadost o prirazeni',
  confirmMessage: 'Odeslat zadost o prirazeni k tymu {teamName}?',
  confirmSend: 'Odeslat',
  confirmCancel: 'Zrusit',
  requestSent: 'Zadost odeslana tymu {teamName}',
  requestCancelled: 'Zadost zrusena',
  noTeams: 'Zadne tymy zatim nejsou k dispozici',
  noResults: 'Zadne tymy neodpovidaji vyhledavani',
  memberCount: '{count} clenu',
  maxRequests: 'Muzete mit maximalne 5 nevyrzenych zadosti',
  alreadyMember: 'Jste jiz clenem tohoto tymu'
}
```

Note: Use proper Czech diacritics (hacky/carky) matching the existing translation style in the codebase.
  </action>
  <verify>
Run `npx tsc --noEmit 2>&1 | head -30` to check for TypeScript errors. Verify TeamBrowseList.vue exists and contains q-input, q-list, q-dialog elements.
  </verify>
  <done>TeamBrowseList.vue component renders teams with search filter, member/pending badges, join confirmation dialog, and cancel action. i18n translations added for both languages.</done>
</task>

<task type="auto">
  <name>Task 2: Integrate TeamBrowseList into onboarding wizard replacing browse placeholder</name>
  <files>
    src/composable/useOnboardingComposable.ts
    src/components/onboarding/OnboardingWizard.vue
    src/components/onboarding/OnboardingWizardMobile.vue
  </files>
  <action>
**1. In `src/components/onboarding/OnboardingWizard.vue` (desktop):**

- Import `TeamBrowseList` from `@/components/onboarding/TeamBrowseList.vue`
- Find the browse placeholder (q-banner or placeholder div in the `teamChoicePath === 'browse'` section of step 3)
- Replace the placeholder banner with `<TeamBrowseList />`
- Keep the existing back button (`backToCardSelection`) above the list

**2. In `src/components/onboarding/OnboardingWizardMobile.vue` (mobile):**

- Same changes as desktop: import TeamBrowseList, replace browse placeholder with `<TeamBrowseList />`
- Keep the existing back button

**3. In `src/composable/useOnboardingComposable.ts`:**

No changes needed — the TeamBrowseList is self-contained and manages its own data fetching. The existing `showSuccess` watcher in the wizard components already detects when `teamStore.teams.length` changes (which happens when a join request is approved and the user gets added to the team). The composable's existing teamChoicePath and backToCardSelection still manage the browse/create toggle.
  </action>
  <verify>
Run `npx tsc --noEmit 2>&1 | head -30`. Verify that both OnboardingWizard.vue and OnboardingWizardMobile.vue import and render TeamBrowseList. Confirm no placeholder banner text remains in the browse section.
  </verify>
  <done>Both wizard variants render TeamBrowseList in the browse path of step 3. Browse placeholder banners are replaced. The full onboarding browse-and-join flow is functional.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with no new errors
2. TeamBrowseList.vue renders teams from Firestore with name, member count, alphabetical sort
3. Text filter at top of list filters teams by name
4. "Member" and "Request Pending" badges display correctly
5. Join button shows confirmation dialog before sending request
6. Cancel request action works from browse list
7. Both OnboardingWizard.vue and OnboardingWizardMobile.vue render TeamBrowseList
8. i18n translations present in both en-US and cs-CZ
</verification>

<success_criteria>
- TeamBrowseList is a self-contained reusable component (no props needed)
- Teams sorted alphabetically with text filter
- Correct badge states: Member (green), Request Pending (warning), or Join button
- Confirmation dialog before sending join request
- Toast notifications for send/cancel actions
- Integrated into both desktop and mobile onboarding wizard variants
- All text internationalized
</success_criteria>

<output>
After completion, create `.planning/phases/12-team-discovery-join-requests/12-02-SUMMARY.md`
</output>
